angular.module("SDLMSys",["ui.bootstrap","ui.router","ngCookies","ngStorage","ngRoute","ngFileUpload","angularUtils.directives.dirPagination","ncy-angular-breadcrumb","ngDialog","checklist-model"]);
"use strict";angular.module("SDLMSys").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,a){t.otherwise("/login"),e.state("base",{"abstract":!0,url:"",views:{"sidebar@":{},"content@":{templateUrl:"templates/base.html"},"headerbar@":{}}}).state("index",{url:"/",parent:"base",views:{"content@":{controller:"AuthCtrl",templateUrl:"templates/login/login.html"}}}).state("login",{url:"/login",parent:"base",views:{"content@":{controller:"AuthCtrl",templateUrl:"templates/login/login.html"}}}).state("logout",{url:"/logout",parent:"base",views:{"content@":{controller:"AuthCtrl",templateUrl:"templates/login/logout.html"}}}).state("register",{url:"/register",parent:"base",views:{"content@":{controller:"AuthCtrl",templateUrl:"templates/register/registeruser.html"}}}).state("registerfailed",{url:"/registerfailed",parent:"base",views:{"content@":{templateUrl:"templates/register/registerfailed.html"}}}).state("registersuccessful",{url:"/registersuccessful",parent:"base",views:{"content@":{templateUrl:"templates/register/registersuccessful.html"}}}).state("base.header",{"abstract":!0,url:"",parent:"base",views:{"headerbar@":{templateUrl:"/templates/partials/headerbar.html"}},ncyBreadcrumb:{label:"Home page"}}).state("base.header.panel",{url:"/controlpanel/:userid",parent:"base.header",views:{"sidebar@":{templateUrl:"/templates/partials/sidebar.html"},"content@":{templateUrl:"/templates/overall/controlpanel.html"},"searchbar@base.header":{templateUrl:"/templates/search/searchuser.html"}},ncyBreadcrumb:{label:"Home page"}}).state("controlpanel",{url:"/controlpanel",parent:"base.header",views:{"sidebar@":{templateUrl:"/templates/partials/sidebar.html"},"content@":{templateUrl:"/templates/overall/controlpanel.html"},"searchbar@base.header":{templateUrl:"/templates/search/searchuser.html"}},ncyBreadcrumb:{label:"Home page"}}).state("searchdocument",{url:"/searchdocument",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/search/searchdocument.html"}},ncyBreadcrumb:{label:"Search Documents"}}).state("suggestdocument",{url:"/suggestdocument",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/suggest/suggestdocument.html"}},ncyBreadcrumb:{label:"Suggest Documents"}}).state("downloaddocument",{url:"/downloaddocument",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/download/downloaddocument.html"}},ncyBreadcrumb:{label:"Download Documents"}}).state("readingdocumentlist",{url:"/readingdocumentlist",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/list/readingdocumentlist.html"}},ncyBreadcrumb:{label:"Reading Documents"}}).state("likeddocumentlist",{url:"/likeddocumentlist",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/list/likeddocumentlist.html"}},ncyBreadcrumb:{label:"Liked Documents"}}).state("shareddocumentlist",{url:"/shareddocumentlist",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/list/shareddocumentlist.html"}},ncyBreadcrumb:{label:"Shared Documents"}}).state("sharedformedocumentlist",{url:"/sharedformedocuments",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/list/sharedformedocumentlist.html"}},ncyBreadcrumb:{label:"Shared For Me Documents"}}).state("uploaddocument",{url:"/uploaddocument",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/upload/uploaddocument.html"}},ncyBreadcrumb:{label:"Upload Document"}}).state("uploaddocumentlist",{url:"/uploaddocumentlist",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/list/uploadeddocumentlist.html"}},ncyBreadcrumb:{label:"Uploaded Documents"}}).state("userinteractionlist",{url:"/userinteractionlist",parent:"base.header.panel",views:{"content@":{templateUrl:"templates/list/userinteractionlist.html"}},ncyBreadcrumb:{label:"User Interaction"}})}]);
"use strict";angular.module("SDLMSys").constant("DEPLOYED_HOST",{URL:"http://localhost:3001"}).constant("SEARCH_HOST",{URL:"http://localhost:9200",MULTI_API:"_msearch",SINGLE_API:"_search"}).constant("PAGINATION",{ITEMS_PER_PAGE:10});
function AlertsCtrl(s){s.alerts=[{type:"success",msg:"It is a successful process"},{type:"danger",msg:"There is a problem occured, please ask your administration to diagnostic and to fix it."}],s.addAlert=function(){s.alerts.push({msg:"Oh la la, There is a new thing pop up!"})},s.closeAlert=function(e){s.alerts.splice(e,1)}}angular.module("SDLMSys").controller("AlertsCtrl",["$scope",AlertsCtrl]);
" use strict";function AuthCtrl(e,o,t,n,s,i,l,r,a,c){console.log("Constructing AuthCtrl..."),o.login=function(){var t=new Date;if(o.password){var n=CryptoJS.SHA1(o.password).toString(),r={email:o.email,password:n};console.log("Login called"),l.login(r,function(e){e.type===!1?(i.wrongCount?(i.wrongCount=i.wrongCount+1,console.log("number of Count : "+i.wrongCount)):i.wrongCount=1,alert(e.data)):(i.wrongCount=0,console.log(e.data),i.myDetail=e.data,o.myDetail=i.myDetail,i.token=e.data.token,i.expiretime=t.now+864e5,s.path("/controlpanel/"+i.myDetail._id))},function(){e.error="Failed to Login!"})}else alert("Password must not be empty! Please provide us your identified password!")},o.register=function(){if(o.password)if(o.retypepwd==o.password){var t=new Date,n=CryptoJS.SHA1(o.password).toString(),r={username:o.username,email:o.email,password:n};console.log("Register called"),l.save(r,function(e){e.type===!1?alert(e.data):(console.log(e.data),i.myDetail=e.data.data,o.myDetail=i.myDetail,i.token=e.data.token,i.expiretime=t.now+864e5,s.path("/registersuccessful"))},function(){e.error="Failed to Register",s.path("/registerfailed")})}else alert("Your password and its retype confirmation are not identical. Please retype them!");else alert("The password and the retyped one must not be empty for verification purpose! Please input them!")},o.me=function(){console.log("Me called"),l.me(function(e){console.log(e),i.myDetail=e.data,o.myDetail=i.myDetail},function(){e.error="Failed to fetch details"})},o.logout=function(){console.log("logout called"),l.logout(function(){s.path("/"),i.myDetail=null,o.myDetail=null},function(){alert("Failed to logout!")})},o.checkForgotPassword=function(){console.log("It called wrongCount: "+i.wrongCount),i.wrongCount>=3?o.isHideForgot=!1:o.isHideForgot=!0},o.hideShowPassword=function(){"password"==o.inputType?o.inputType="text":o.inputType="password"},o.myDetail=i.myDetail,o.token=i.token,o.inputType="password",o.stats={},o.currentUser={},o.userReadDocs=[],o.numberOfUserReadDocs=0,o.currentPage=0,o.pageSize=2*c.ITEMS_PER_PAGE,o.numberOfPages=function(){return Math.ceil(o.userReadDocs/o.pageSize)},o.getUserReadingDocuments=function(t){r.getUserReadingDocs(t,function(e){console.log(e.data),e.type?(o.userReadDocs=e.data,o.numberOfUserReadDocs=o.userReadDocs.length):(o.userReadDocs=[],o.numberOfUserReadDocs=0)},function(){o.userReadDocs=[],o.numberOfUserReadDocs=0,e.error="Failed to fetch documents information"})},o.getStatistic=function(){if(null!=o.myDetail){var e=o.myDetail._id;o.strViewingUser=o.myDetail.username,o.bFriendRequestSent=!1,o.bSendFriendRequest=!1,o.bResponseFriendRequest=!1,o.bRequestFollowRequest=!1,o.bBeFriend=!1,console.log(o.myDetail),console.log(i.lastSelectedItem),"undefined"!==n.userid&&"undefined"!==o.myDetail._id&&n.userid!==o.myDetail._id&&i.lastSelectedItem.id==n.userid&&(e=n.userid,o.strViewingUser=i.lastSelectedItem.username,o.myDetail.friends.length>=0&&-1===o.myDetail.friends.indexOf(n.userid)?-1!==o.myDetail.wait_response_friends.indexOf(n.userid)?(console.log("Waiting for response friends"),o.bFriendRequestSent=!0):-1!==o.myDetail.request_friends.indexOf(n.userid)?(console.log("Received a friend request"),o.bResponseFriendRequest=!0):(console.log("Received a friend request"),o.bSendFriendRequest=!0,-1===o.myDetail.followers.indexOf(n.userid)&&(o.bRequestFollowRequest=!0)):o.bBeFriend=!0),o.myid=e,console.log(e+" - "+o.myDetail._id+" or "+n.userid),o.getUserReadingDocuments(e),l.getStatistic(e,function(e){console.log(e),o.stats=e},function(e){console.log(e)}),l.getUserInformation(e,function(e){console.log(e),e.type?o.currentUser=e.data:o.currentUser=o.myDetail},function(e){console.log(e)})}},o.me(),o.getStatistic(),o.sendFriendRequest=function(){if(console.log("Send Friend Request"),o.bSendFriendRequest){var e={friend_id:n.userid};console.log(n),l.sendFriendRequest(e,function(e){console.log("SendRequestSuccess"),console.log(e),o.me(),setTimeout(function(){o.$apply(function(){o.getStatistic()})},500)},function(e){console.log("SendRequestFailed"),console.log(e)})}},o.sendFriendResponse=function(){if(console.log("Send Friend Response"),o.bResponseFriendRequest){var e={friend_id:n.userid};console.log(n),l.sendFriendResponse(e,function(e){console.log("SendResponseSuccess"),console.log(e),o.me(),setTimeout(function(){o.$apply(function(){o.getStatistic()})},500)},function(e){console.log("SendResponseFailed"),console.log(e)})}},o.confirmFollow=function(){if(console.log("confirm follow Response"),o.bRequestFollowRequest){console.log(n);var e={follower_id:n.userid};l.sendConfirmFollow(e,function(e){console.log("sendConfirmFollowSuccess"),console.log(e),o.me(),setTimeout(function(){o.$apply(function(){o.getStatistic()})},500)},function(e){console.log("sendConfirmFollowFailed"),console.log(e)})}},o.getServerDocumentPath=function(e){return r.getDocPath(e)},o.userInteract=function(e,t,n){console.log("Document Id: "+e+" - with user action : "+t+" - data : "+n);var s={doc_id:e,the_action:t,the_data:n};UserActSvc.interactDocument(s,function(e){console.log(e),setTimeout(function(){o.me(),o.$apply(function(){o.getStatistic()})},500)},function(e){console.log(e)})},o.openShare=function(e){o.doc_id=e,a.open({template:"firstDialog",controller:"PopupShareCtrl",className:"ngdialog-theme-default ngdialog-theme-custom",scope:o})}}angular.module("SDLMSys").controller("AuthCtrl",["$rootScope","$scope","$route","$stateParams","$location","$localStorage","MainSvc","DocumentSvc","ngDialog","PAGINATION",AuthCtrl]);
" use strict";function DocumentCtrl(e,o,t,n,a,c,l,u){function d(){e.file=void 0}function r(o){o.getMines(function(o){e.uploadedDocs=o.data,e.numberOfDocs=e.uploadedDocs.length;var t={};if(e.numberOfDocs>0){for(i=0;i<e.numberOfDocs;i++){var n=new Date(e.uploadedDocs[i].uploadedDate),a=n.valueOf(),c=Math.ceil(a/864e5);t[c]?t[c]=t[c]+1:t[c]=1}for(date in t)e.peakUploaded<t[date]&&(e.peakUploaded=t[date]);e.averageTimePerDay=(e.numberOfDocs/Object.keys(t).length).toFixed(2),console.log(t)}},function(){$rootScope.error="Failed to fetch documents information"})}function s(o){a.updateInfo(o,function(o){e.editingDoc=null,r(a),e.exitEditing()},function(o){e.editingDoc=null})}console.log("Constructing DocumentCtrl..."),e.uploadedDocs=[],e.myid=o.myDetail._id,e.title="",e.authors="",e["abstract"]="",e.publisher="",e.publishedDate="",e.privacy="",e.category="",e.demomode="",e.log="",e.isSucceedUpload=0,e.isEditing=!1,isLoading=!1,e.peakUploaded=0,e.averageTimePerDay=0,e.selectFile=function(o){e.file=o,console.log("play here")},e.uploadDocument=function(){e.uploadFile(e.file)},e.clearLog=function(){e.log="",e.isSucceedUpload=0},e.submit=function(){e.uploadDocument()},e.uploadFile=function(o){o?(e.clearLog(),console.log("come here 3 - 1!"),o.upload=t.upload({url:"http://localhost:3001/uploadDoc",data:{username:e.username,title:e.title,authors:e.authors,"abstract":e["abstract"],publisher:e.publisher,publishedDate:e.publishedDate,privacy:e.privacy,category:e.category,demomode:e.demomode,file:o}}).then(function(t){console.log("Running here!"),n(function(){var i="file: "+t.config.data.file.name+", Response: "+JSON.stringify(t.data);e.log=i,o.result=t.data,e.isSucceedUpload=e.isSucceedUpload+1}),e.isSucceedUpload=e.isSucceedUpload+1,console.log("Running here out! 1"),d()},function(o){o.status>0&&(e.log=o.status+": "+o.data)},function(t){var i=parseInt(100*t.loaded/t.total);o.progress=Math.min(i),e.log="progress: "+i+"% "+t.config.data.file.name,e.isSucceedUpload=e.isSucceedUpload+1})):(e.log="$scope.file is null",console.log(e.log),console.log(e))},e.editDocument=function(o){e.isEditing=!0,e.editingDoc=o,e.title=o.title,e.authors=o.authors,e["abstract"]=o["abstract"],e.publisher=o.publisher,e.publishedDate=o.publishedDate,e.privacy=o.privacy,e.category=o.category},e.saveEditedDoc=function(){e.editingDoc.title=e.title,e.editingDoc.authors=e.authors,e.editingDoc["abstract"]=e["abstract"],e.editingDoc.publisher=e.publisher,e.editingDoc.publishedDate=e.publishedDate,e.editingDoc.privacy=e.privacy,e.editingDoc.category=e.category,s(e.editingDoc)},e.exitEditing=function(){e.editingDoc=null,e.title="",e.authors="",e["abstract"]="",e.publisher="",e.publishedDate="",e.isEditing=!1,e.privacy="",e.category="",e.demomode=""},e.deleteDocument=function(o,t){a.removeDoc(t,function(e){console.log("delete document result: ",e)},function(e){console.log("Error when delete document: ",e)}),e.uploadedDocs.slice(o,1),r(a)},e.getServerDocumentPath=function(e){return a.getDocPath(e)},e.downloadDocument=function(e){console.log("come here 9!");var o=document.createElement("a");document.body.appendChild(o),o.style="display: none",o.href=a.getDocPath(e.uploadedPath),o.download=e.fileName,o.click(),document.body.removeChild(o)},e.$watch("isSucceedUpload",function(){e.isLoading=!0,r(a),e.isLoading=!1}),e.currentPage=0,e.pageSize=u.ITEMS_PER_PAGE,e.numberOfPages=function(){return Math.ceil(e.uploadedDocs/e.pageSize)},e.userInteract=function(o,t,i){console.log("Document Id: "+o+" - with user action : "+t+" - data : "+i);var n={doc_id:o,the_action:t,the_data:i};c.interactDocument(n,function(o){console.log(o),setTimeout(function(){e.$apply(function(){r(a)})},500)},function(e){console.log(e)})},e.openShare=function(o){e.doc_id=o,l.open({template:"firstDialog",controller:"PopupShareCtrl",className:"ngdialog-theme-default ngdialog-theme-custom",scope:e})}}angular.module("SDLMSys").controller("DocumentCtrl",["$scope","$localStorage","Upload","$timeout","DocumentSvc","UserActSvc","ngDialog","PAGINATION",DocumentCtrl]);
" use strict";function DownloadCtrl(o,e,n,t,a,c){function l(e){e.getMyDownloadedDocs(function(e){console.log(e.data),o.downloadedDocs=e.data,o.numberOfDocs=o.downloadedDocs.length},function(){$rootScope.error="Failed to fetch documents information"})}console.log("Constructing DownloadCtrl..."),o.downloadedDocs=[],o.myid=e.myDetail._id,o.log="",o.peakDownload=0,o.averageTimePerDay=0,o.clearLog=function(){o.log=""},l(n),o.getServerDocumentPath=function(o){return n.getDocPath(o)},o.currentPage=0,o.pageSize=c.ITEMS_PER_PAGE,o.numberOfPages=function(){return Math.ceil(o.downloadedDocs/o.pageSize)},o.userInteract=function(e,a,c){console.log("Document Id: "+e+" - with user action : "+a+" - data : "+c);var r={doc_id:e,the_action:a,the_data:c};t.interactDocument(r,function(e){console.log(e),setTimeout(function(){o.$apply(function(){l(n)})},500)},function(o){console.log(o)})},o.openShare=function(e){o.doc_id=e,a.open({template:"firstDialog",controller:"PopupShareCtrl",className:"ngdialog-theme-default ngdialog-theme-custom",scope:o})}}angular.module("SDLMSys").controller("DownloadCtrl",["$scope","$localStorage","DocumentSvc","UserActSvc","ngDialog","PAGINATION",DownloadCtrl]);
" use strict";function LikeCtrl(o,e,t,n,c,i){function l(e){e.getMyLikedDocs(function(e){console.log(e.data),o.likeDocs=e.data,o.numberOfDocs=o.likeDocs.length},function(){$rootScope.error="Failed to fetch documents information"})}console.log("Constructing LikeCtrl..."),o.likeDocs=[],o.myid=e.myDetail._id,o.log="",o.clearLog=function(){o.log=""},l(t),o.getServerDocumentPath=function(o){return t.getDocPath(o)},o.currentPage=0,o.pageSize=i.ITEMS_PER_PAGE,o.numberOfPages=function(){return Math.ceil(o.likeDocs/o.pageSize)},o.userInteract=function(e,c,i){console.log("Document Id: "+e+" - with user action : "+c+" - data : "+i);var a={doc_id:e,the_action:c,the_data:i};n.interactDocument(a,function(e){console.log(e),setTimeout(function(){o.$apply(function(){l(t)})},500)},function(o){console.log(o)})},o.openShare=function(e){o.doc_id=e,c.open({template:"firstDialog",controller:"PopupShareCtrl",className:"ngdialog-theme-default ngdialog-theme-custom",scope:o})}}angular.module("SDLMSys").controller("LikeCtrl",["$scope","$localStorage","DocumentSvc","UserActSvc","ngDialog","PAGINATION",LikeCtrl]);
" use strict";function MasterCtrl(t,e,o){console.log("Constructing MasterCtrl...");var g=992;t.getWidth=function(){return window.innerWidth},t.$watch(t.getWidth,function(o,l){o>=g?angular.isDefined(e.get("toggle"))?t.toggle=!!e.get("toggle"):t.toggle=!0:t.toggle=!1}),t.toggleSidebar=function(){t.toggle=!t.toggle,e.put("toggle",t.toggle)},window.onresize=function(){t.$apply()},console.log(t),t.myDetail=o.myDetail,t.token=o.token}angular.module("SDLMSys").controller("MasterCtrl",["$scope","$cookieStore","$localStorage",MasterCtrl]);
" use strict";function PopupShareCtrl(e,n,s,r){console.log("Constructing PopupShareCtrl..."),e.friends=[],e.init=function(){s.getMyFriendList(function(n){console.log(n),n.type?e.friends=n.data:e.friends=[]},function(n){e.friends=[],console.log(n)})},e.init(),e.shareText="",e.selectedFriends=[],e.compareFn=function(e,n){return e._id===n._id},e.checkAll=function(){e.selectedFriends.splice(0,e.selectedFriends.length);for(var n in e.friends)e.selectedFriends.push(e.friends[n])},e.uncheckAll=function(){e.selectedFriends.splice(0,e.selectedFriends.length)},e.submit=function(){var n={};console.log(e.shareText),console.log(e.selectedFriends),n.toFriends=e.selectedFriends,n.shareText=e.shareText,e.userInteract(e.doc_id,"share",n),r.close()}}angular.module("SDLMSys").controller("PopupShareCtrl",["$scope","$localStorage","UserSvc","ngDialog",PopupShareCtrl]);
" use strict";function ReadCtrl(o,e,t,n,c,a){function r(e){e.getMyReadingDocs(function(e){console.log(e.data),o.readDocs=e.data,o.numberOfDocs=o.readDocs.length},function(){$rootScope.error="Failed to fetch documents information"})}console.log("Constructing ReadCtrl..."),o.readDocs=[],o.myid=e.myDetail._id,o.log="",o.clearLog=function(){o.log=""},r(t),o.getServerDocumentPath=function(o){return t.getDocPath(o)},o.currentPage=0,o.pageSize=a.ITEMS_PER_PAGE,o.numberOfPages=function(){return Math.ceil(o.readDocs/o.pageSize)},o.userInteract=function(e,c,a){console.log("Document Id: "+e+" - with user action : "+c+" - data : "+a);var l={doc_id:e,the_action:c,the_data:a};n.interactDocument(l,function(e){console.log(e),setTimeout(function(){o.$apply(function(){r(t)})},500)},function(o){console.log(o)})},o.openShare=function(e){o.doc_id=e,c.open({template:"firstDialog",controller:"PopupShareCtrl",className:"ngdialog-theme-default ngdialog-theme-custom",scope:o})}}angular.module("SDLMSys").controller("ReadCtrl",["$scope","$localStorage","DocumentSvc","UserActSvc","ngDialog","PAGINATION",ReadCtrl]);
" use strict";function SearchCtrl(o,e,t,r,s,a,n,c){function l(){o.errorLog="",o.resultLog="",o.totalDocs=0,o.resultDocs=[]}function u(e){l(),t.searchData(e,o.privacy,o.category,o.demomode,0,o.pageSize,function(e){if(console.log(e),200==e.status){if(e.data){o.resultDocs=[];var t=e.data.responses.length,r=0;for(i=0;i<t;i++)e.data.responses[i].error?(o.errorLog=o.errorLog+e.data.responses[i].error.index+" - "+e.data.responses[i].error.reason,o.resultLog="There is no document found"):(o.resultDocs=o.resultDocs.concat(e.data.responses[i].hits.hits),r+=e.data.responses[i].hits.total);o.totalDocs=r}}else console.log(e.statusText),o.errorLog=e.statusText},function(e){o.errorLog=e})}function g(e){o.isLoading=!0,t.searchData(o.query,o.privacy,o.category,o.demomode,(e-1)*o.pageSize,o.pageSize,function(e){if(console.log(e),200==e.status){if(e.data){o.resultDocs=[];var t=e.data.responses.length,r=0;for(i=0;i<t;i++)e.data.responses[i].error?(o.errorLog=o.errorLog+e.data.responses[i].error.index+" - "+e.data.responses[i].error.reason,o.resultLog="There is no document found"):(o.resultDocs=o.resultDocs.concat(e.data.responses[i].hits.hits),r+=e.data.responses[i].hits.total);o.totalDocs=r,o.isLoading=!1}}else console.log(e.statusText),o.errorLog=e.statusText},function(e){o.errorLog=e})}console.log("Constructing SearchCtrl..."),o.resultDocs=[],o.errorLog="",o.submit=function(){o.isLoading=!0,u(o.query),o.isLoading=!1},o.$watch("query",function(e){o.isLoading=!0,u(e),o.isLoading=!1}),o.$watch("demomode",function(e){o.isLoading=!0,u(o.query),o.isLoading=!1}),o.$watch("category",function(e){o.isLoading=!0,u(o.query),o.isLoading=!1}),o.$watch("privacy",function(e){o.isLoading=!0,u(o.query),o.isLoading=!1}),o.pageChanged=function(o){g(o)},o.pagination={current:1},o.pageSize=c.ITEMS_PER_PAGE,o.totalDocs=0,o.getServerDocumentPath=function(o){return r.getDocPath(o)},o.me=function(){a.me(function(t){console.log(t),e.myDetail=t.data,o.myDetail=e.myDetail,console.log(e.myDetail)},function(){$rootScope.error="Failed to fetch details"})},o.userInteract=function(e,t,r){console.log("Document Id: "+e+" - with user action : "+t+" - data : "+r);var a={doc_id:e,the_action:t,the_data:r};s.interactDocument(a,function(e){console.log(e),setTimeout(function(){o.$apply(function(){o.me()})},500)},function(o){console.log(o)})},o.openShare=function(e){o.doc_id=e,n.open({template:"firstDialog",controller:"PopupShareCtrl",className:"ngdialog-theme-default ngdialog-theme-custom",scope:o})},o.me()}angular.module("SDLMSys").controller("SearchCtrl",["$scope","$localStorage","SearchSvc","DocumentSvc","UserActSvc","MainSvc","ngDialog","PAGINATION",SearchCtrl]);
" use strict";function ShareCtrl(o,e,t,n,c,a,r){function l(e){e.getMySharedDocs(function(e){console.log(e.data),o.sharedDocs=e.data,o.numberOfDocs=o.sharedDocs.length},function(){$rootScope.error="Failed to fetch documents information"})}console.log("Constructing ShareCtrl..."),o.sharedDocs=[],o.myid=t.myDetail._id,o.log="",o.clearLog=function(){o.log=""},l(n),o.getServerDocumentPath=function(o){return n.getDocPath(o)},o.currentPage=0,o.pageSize=r.ITEMS_PER_PAGE,o.numberOfPages=function(){return Math.ceil(o.sharedDocs/o.pageSize)},o.userInteract=function(e,t,a){console.log("Document Id: "+e+" - with user action : "+t+" - data : "+a);var r={doc_id:e,the_action:t,the_data:a};c.interactDocument(r,function(e){console.log(e),setTimeout(function(){o.$apply(function(){l(n)})},500)},function(o){console.log(o)})},o.openShare=function(e){o.doc_id=e,a.open({template:"firstDialog",controller:"PopupShareCtrl",className:"ngdialog-theme-default ngdialog-theme-custom",scope:o})}}angular.module("SDLMSys").controller("ShareCtrl",["$scope","$timeout","$localStorage","DocumentSvc","UserActSvc","ngDialog","PAGINATION",ShareCtrl]);
" use strict";function ShareForMeCtrl(e,o,t,n,a,r,c){function i(o){o.getSharedForMeDocuments(function(o){console.log(o.data),o.type?(e.sharedTransactions=o.data,"undefined"!=typeof o.data?e.numberOfDocs=e.sharedTransactions.length:e.numberOfDocs=0):(e.sharedTransactions=[],e.numberOfDocs=0)},function(){$rootScope.error="Failed to fetch documents information"})}console.log("Constructing ShareForMeCtrl..."),e.sharedTransactions=[],e.myid=t.myDetail._id,e.log="",e.clearLog=function(){e.log=""},i(n),e.getServerDocumentPath=function(e){return n.getDocPath(e)},e.currentPage=0,e.pageSize=c.ITEMS_PER_PAGE,e.numberOfPages=function(){return Math.ceil(e.sharedTransactions/e.pageSize)},e.userInteract=function(o,t,r){console.log("Document Id: "+o+" - with user action : "+t+" - data : "+r);var c={doc_id:o,the_action:t,the_data:r};a.interactDocument(c,function(o){console.log(o),setTimeout(function(){e.$apply(function(){i(n)})},500)},function(e){console.log(e)})},e.openShare=function(o){e.doc_id=o,r.open({template:"firstDialog",controller:"PopupShareCtrl",className:"ngdialog-theme-default ngdialog-theme-custom",scope:e})}}angular.module("SDLMSys").controller("ShareForMeCtrl",["$scope","$timeout","$localStorage","DocumentSvc","UserActSvc","ngDialog","PAGINATION",ShareForMeCtrl]);
" use strict";function UserSearchCtrl(e,t,r,s,l){function o(){e.errorLog="",e.resultLog="",e.resultUsers.splice(0,e.resultUsers.length)}console.log("Constructing UserSearchCtrl..."),e.resultUsers=[],e.limits=10,e.getUsers=function(r){o();var s=l.URL+"/doclib_main/User/"+l.SINGLE_API+"?q="+r+"&from=0&size="+e.limits;return t.get(s).then(function(t){if(console.log(t),200==t.status){if(t.data)for(var r=t.data.hits.hits.length,s=0;r>s;s++)e.resultUsers.push(t.data.hits.hits[s]._source)}else e.errorLog=t.statusText;return e.resultUsers})},e.selectUser=function(e,t,l,o){s.lastSelectedItem=e,r.path("/controlpanel/"+e.id)}}angular.module("SDLMSys").controller("UserSearchCtrl",["$scope","$http","$location","$localStorage","SEARCH_HOST",UserSearchCtrl]);
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("SDLMSys").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"@?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("SDLMSys").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("SDLMSys").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("SDLMSys").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("SDLMSys").directive("rdWidget",rdWidget);
" use strict";angular.module("SDLMSys").filter("startFrom",function(){return function(r,t){return t=+t,r.slice(t)}});
"use strict";angular.module("SDLMSys").config(["$httpProvider",function(t){t.interceptors.push(["$q","$location","$localStorage","Utils","SEARCH_HOST",function(t,r,e,n,o){return{request:function(t){return t.headers=t.headers||{},e.token&&!t.url.match(o.MULTI_API)&&(t.headers.Authorization="Bearer "+e.token),t},responseError:function(e){return 401!==e.status&&403!==e.status||r.path("/"),t.reject(e)}}}])}]);
"use strict";function DocumentSvc(e,c,o){var s=o.URL;return{getMines:function(c,o){e.get(s+"/mydocs").success(c).error(o)},updateInfo:function(c,o,t){e.post(s+"/updatedocument",c).success(o).error(t)},removeDoc:function(c,o,t){e.post(s+"/deletedocument",c).success(o).error(t)},getDocPath:function(e){return s+"/"+e},getMyDownloadedDocs:function(c,o){e.get(s+"/mydownloadeddocuments").success(c).error(o)},getMyLikedDocs:function(c,o){e.get(s+"/mylikeddocuments").success(c).error(o)},getMyReadingDocs:function(c,o){e.get(s+"/myreadingdocuments").success(c).error(o)},getMySharedDocs:function(c,o){e.get(s+"/myshareddocuments").success(c).error(o)},getUserReadingDocs:function(c,o,t){e.get(s+"/userReadingDocs?userid="+c).success(o).error(t)},getSharedForMeDocuments:function(c,o){e.get(s+"/sharedForMeDocuments").success(c).error(o)}}}angular.module("SDLMSys").factory("DocumentSvc",["$http","$localStorage","DEPLOYED_HOST",DocumentSvc]);
"use strict";function MainSvc(e,s,o){var n=o.URL;return{save:function(s,o,t){e.post(n+"/signup",s).success(o).error(t)},login:function(s,o,t){e.post(n+"/authen",s).success(o).error(t)},me:function(s,o){e.get(n+"/me").success(s).error(o)},getUserInformation:function(s,o,t){e.get(n+"/getUserInformation?userid="+s).success(o).error(t)},getStatistic:function(s,o,t){e.get(n+"/stats?uid="+s).success(o).error(t)},logout:function(e){console.log("Logout has been called"),delete s.token,delete s.myDetail,e()},sendFriendRequest:function(s,o,t){e.post(n+"/requestFriend",s).success(o).error(t)},sendFriendResponse:function(s,o,t){e.post(n+"/requestResponse",s).success(o).error(t)},sendConfirmFollow:function(s,o,t){e.post(n+"/confirmFollow",s).success(o).error(t)}}}angular.module("SDLMSys").factory("MainSvc",["$http","$localStorage","DEPLOYED_HOST",MainSvc]);
"use strict";function SearchSvc(e,r,t){return{searchData:function(i,o,n,u,s,p,l,y){var c=t.URL+"/"+t.MULTI_API,_="",d=r.myDetail;void 0===i&&(i="*");var m="",a="",q="";void 0!==n&&"all"!==n&&""!==n&&(m='"filter": {"match": {"category": { "query":    "'+n+'","operator": "and"}}}, "must" : ',a='{ "query" : {"bool" : {',q="}}}"),"pubnpri"===o?(console.log("my Public and my Private"),"2"===u?(d&&(_='{ "index" : "doclib2", "type":"Document_public", "routing" : "'+d._id+'", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n',_=_+'{ "index" : "doclib2", "type":"Document_private", "routing" : "'+d._id+'", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Custom routing with one index and 3 public/private/share types")):"3"===u?(d&&(_='{ "index" : "doclib3_'+d._id+'_public", "type":"Document", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n',_=_+'{ "index" : "doclib3_'+d._id+'_privacy", "type":"Document", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Separate indexes for users")):"4"===u?(d&&(_='{ "index" : "doclib4_'+d._id+'", "type":"Document_public", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n',_=_+'{ "index" : "doclib4_'+d._id+'", "type": "Document_private", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Separate types for private/public/share")):(d&&(_='{"index" : "doclib_public", "type":"Document", "routing" :  "'+d._id+'", "pretty": "true"}\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n',_=_+'{"index" : "doclib_private", "type":"Document", "routing" :  "'+d._id+'", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Custom routing with 3 public/private/share indexes"))):"public"===o?(console.log("my Public only"),"2"===u?(d&&(_='{ "index" : "doclib2", "type":"Document_public", "routing" : "'+d._id+'", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Custom routing with one index and 3 public/private/share types")):"3"===u?(d&&(_='{ "index" : "doclib3_'+d._id+'_public", "type":"Document", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Separate indexes for users")):"4"===u?(d&&(_='{ "index" : "doclib4_'+d._id+'", "type":"Document_public", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Separate types for private/public/share")):(d&&(_='{"index" : "doclib_public", "type":"Document", "routing" :  "'+d._id+'", "pretty": "true"}\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Custom routing with 3 public/private/share indexes"))):"private"===o?(console.log("my Private only"),"2"===u?(d&&(_='{ "index" : "doclib2", "type":"Document_private", "routing" : "'+d._id+'", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Custom routing with one index and 3 public/private/share types")):"3"===u?(d&&(_='{ "index" : "doclib3_'+d._id+'_private", "type":"Document", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Separate indexes for users")):"4"===u?(d&&(_='{ "index" : "doclib4_'+d._id+'", "type":"Document_private", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Separate types for private/public/share")):(d&&(_='{"index" : "doclib_private", "type":"Document", "routing" :  "'+d._id+'", "pretty": "true"}\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Custom routing with 3 public/private/share indexes"))):(console.log("All Public and my Private"),"2"===u?(_='{ "index" : "doclib2", "type":"Document_public", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n',d&&(_=_+'{ "index" : "doclib2", "type":"Document_private", "routing" : "'+d._id+'", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Custom routing with one index and 3 public/private/share types")):"3"===u?(_='{ "index" : "doclib3_*_public", "type":"Document", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n',d&&(_=_+'{ "index" : "doclib3_'+d._id+'_privacy", "type":"Document", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Separate indexes for users")):"4"===u?(_='{ "index" : "doclib4_*", "type":"Document_public", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n',d&&(_=_+'{ "index" : "doclib4_'+d._id+'", "type": "Document_private", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Separate types for private/public/share")):(_='{"index" : "doclib_public", "type":"Document", "pretty": "true"}\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n',d&&(_=_+'{"index" : "doclib_private", "type":"Document", "routing" :  "'+d._id+'", "pretty": "true" }\r\n'+a+m+'{ "query" : {"simple_query_string" : {"query" : "'+i+'"}}'+q+', "from" : "'+s+'", "size" : "'+p+'"}\r\n'),console.log("Custom routing with 3 public/private/share indexes")));var g={method:"POST",url:c,headers:{"Content-Type":"application/x-www-form-urlencoded"},data:_};console.log("=============SEARCH CONFIG============="),console.log(_),console.log(g),console.log("=============SEARCH CONFIG============="),e(g).then(function(e){"function"==typeof l&&l(e)},function(e){"function"==typeof y&&y(e)})},searchUser:function(r,i,o,n,u){var s=t.URL+"/doclib_main/User/"+t.SINGLE_API+"?q="+r+"&from="+i+"&size="+o,p={method:"GET",url:s};console.log("=============SEARCH CONFIG============="),console.log(p),console.log("=============SEARCH CONFIG============="),e(p).then(function(e){"function"==typeof n&&n(e)},function(e){"function"==typeof u&&u(e)})}}}angular.module("SDLMSys").factory("SearchSvc",["$http","$localStorage","SEARCH_HOST",SearchSvc]);
"use strict";function UserActSvc(t,c,r){var e=r.URL;return{interactDocument:function(c,r,s){t.post(e+"/userInteractDocument",c).success(r).error(s)}}}angular.module("SDLMSys").factory("UserActSvc",["$http","$localStorage","DEPLOYED_HOST",UserActSvc]);
"use strict";function UserSvc(r,e,t){var s=t.URL;return{getMyFriendList:function(e,t){r.get(s+"/myfriends").success(e).error(t)}}}angular.module("SDLMSys").factory("UserSvc",["$http","$localStorage","DEPLOYED_HOST",UserSvc]);
"use strict";function Utils(){function n(n){for(var n=btoa(unescape(encodeURIComponent(n))),t=n.split(""),o=[],r=0;r<t.length;r++)o.push(t[r].charCodeAt(0));return new Uint8Array(o)}function t(n){var t=String.fromCharCode.apply(null,n),o=decodeURIComponent(escape(atob(t)));return o}return{convertStringToBinary:function(t,o){var r=n(t);"function"==typeof o&&o(r)},convertBinaryToString:function(n,o){var r=t(n);"function"==typeof o&&o(r)}}}angular.module("SDLMSys").factory("Utils",[Utils]);