angular.module("SDLMSys",["ui.bootstrap","ui.router","ngCookies","ngStorage","ngRoute","ngFileUpload","angularUtils.directives.dirPagination","ncy-angular-breadcrumb"]);
"use strict";angular.module("SDLMSys").config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/login"),e.state("base",{"abstract":!0,url:"",views:{"sidebar@":{},"content@":{templateUrl:"templates/base.html"},"headerbar@":{}}}).state("index",{url:"/",parent:"base",views:{"content@":{controller:"AuthCtrl",templateUrl:"templates/login/login.html"}}}).state("login",{url:"/login",parent:"base",views:{"content@":{controller:"AuthCtrl",templateUrl:"templates/login/login.html"}}}).state("logout",{url:"/logout",parent:"base",views:{"content@":{controller:"AuthCtrl",templateUrl:"templates/login/logout.html"}}}).state("register",{url:"/register",parent:"base",views:{"content@":{controller:"AuthCtrl",templateUrl:"templates/register/registeruser.html"}}}).state("registerfailed",{url:"/registerfailed",parent:"base",views:{"content@":{templateUrl:"templates/register/registerfailed.html"}}}).state("registersuccessful",{url:"/registersuccessful",parent:"base",views:{"content@":{templateUrl:"templates/register/registersuccessful.html"}}}).state("controlpanel",{url:"/controlpanel",parent:"base",views:{"sidebar@":{templateUrl:"/templates/partials/sidebar.html"},"content@":{templateUrl:"/templates/overall/controlpanel.html"},"headerbar@":{templateUrl:"/templates/partials/headerbar.html"}},ncyBreadcrumb:{label:"Home page"}}).state("searchdocument",{url:"/searchdocument",parent:"controlpanel",views:{"content@":{templateUrl:"templates/search/searchdocument.html"}},ncyBreadcrumb:{label:"Search Documents"}}).state("suggestdocument",{url:"/suggestdocument",parent:"controlpanel",views:{"content@":{templateUrl:"templates/suggest/suggestdocument.html"}},ncyBreadcrumb:{label:"Suggest Documents"}}).state("downloaddocument",{url:"/downloaddocument",parent:"controlpanel",views:{"content@":{templateUrl:"templates/download/downloaddocument.html"}},ncyBreadcrumb:{label:"Download Documents"}}).state("readingdocumentlist",{url:"/readingdocumentlist",parent:"controlpanel",views:{"content@":{templateUrl:"templates/list/readingdocumentlist.html"}},ncyBreadcrumb:{label:"Reading Documents"}}).state("likeddocumentlist",{url:"/likeddocumentlist",parent:"controlpanel",views:{"content@":{templateUrl:"templates/list/likeddocumentlist.html"}},ncyBreadcrumb:{label:"Liked Documents"}}).state("shareddocumentlist",{url:"/shareddocumentlist",parent:"controlpanel",views:{"content@":{templateUrl:"templates/list/shareddocumentlist.html"}},ncyBreadcrumb:{label:"Shared Documents"}}).state("uploaddocument",{url:"/uploaddocument",parent:"controlpanel",views:{"content@":{templateUrl:"templates/upload/uploaddocument.html"}},ncyBreadcrumb:{label:"Upload Document"}}).state("uploaddocumentlist",{url:"/uploaddocumentlist",parent:"controlpanel",views:{"content@":{templateUrl:"templates/list/uploadeddocumentlist.html"}},ncyBreadcrumb:{label:"Uploaded Documents"}}).state("userinteractionlist",{url:"/userinteractionlist",parent:"controlpanel",views:{"content@":{templateUrl:"templates/list/userinteractionlist.html"}},ncyBreadcrumb:{label:"User Interaction"}})}]);
function AlertsCtrl(s){s.alerts=[{type:"success",msg:"It is a successful process"},{type:"danger",msg:"There is a problem occured, please ask your administration to diagnostic and to fix it."}],s.addAlert=function(){s.alerts.push({msg:"Oh la la, There is a new thing pop up!"})},s.closeAlert=function(e){s.alerts.splice(e,1)}}angular.module("SDLMSys").controller("AlertsCtrl",["$scope",AlertsCtrl]);
" use strict";function AuthCtrl(o,e,t,n,a){console.log("Constructing AuthCtrl..."),e.login=function(){var t=new Date;if(e.password){var r=CryptoJS.SHA1(e.password).toString(),i={email:e.email,password:r};console.log("Login called"),a.login(i,function(o){o.type===!1?(n.wrongCount?(n.wrongCount=n.wrongCount+1,console.log("number of Count : "+n.wrongCount)):n.wrongCount=1,alert(o.data)):(n.wrongCount=0,console.log(o.data),n.myDetail=o.data,n.token=o.data.token,n.expiretime=t.now+864e5,window.location="#/controlpanel")},function(){o.error="Failed to Login!"})}else alert("Password must not be empty! Please provide us your identified password!")},e.register=function(){if(e.password)if(e.retypepwd==e.password){var t=new Date,r=CryptoJS.SHA1(e.password).toString(),i={username:e.username,email:e.email,password:r};console.log("Register called"),a.save(i,function(o){o.type===!1?alert(o.data):(console.log(o.data),n.myDetail=o.data.data,n.token=o.data.token,n.expiretime=t.now+864e5,window.location="#/registersuccessful")},function(){o.error="Failed to Register",window.location="#/registerfailed"})}else alert("Your password and its retype confirmation are not identical. Please retype them!");else alert("The password and the retyped one must not be empty for verification purpose! Please input them!")},e.me=function(){console.log("Me called"),a.me(function(o){e.myDetails=o},function(){o.error="Failed to fetch details"})},e.logout=function(){console.log("logout called"),a.logout(function(){window.location="/"},function(){alert("Failed to logout!")})},e.checkForgotPassword=function(){console.log("It called wrongCount: "+n.wrongCount),n.wrongCount>=3?e.isHideForgot=!1:e.isHideForgot=!0},e.hideShowPassword=function(){"password"==e.inputType?e.inputType="text":e.inputType="password"},e.myDetail=n.myDetail,e.token=n.token,e.inputType="password"}angular.module("SDLMSys").controller("AuthCtrl",["$rootScope","$scope","$location","$localStorage","MainSvc",AuthCtrl]);
" use strict";function DocumentCtrl(e,t,o,a,n,c){function l(t,o){t.getMines(function(t){e.uploadedDocs=t.data,e.numberOfDocs=e.uploadedDocs.length;var o={};if(e.numberOfDocs>0){for(i=0;i<e.numberOfDocs;i++){var a=new Date(e.uploadedDocs[i].uploadedDate),n=a.valueOf(),c=Math.ceil(n/864e5);o[c]?o[c]=o[c]+1:o[c]=1}for(date in o)e.peakUploaded<o[date]&&(e.peakUploaded=o[date]);e.averageTimePerDay=(e.numberOfDocs/Object.keys(o).length).toFixed(2),console.log(o)}},function(){$rootScope.error="Failed to fetch documents information"})}function u(t){n.updateInfo(t,function(t){e.editingDoc=null,l(n),e.exitEditing()},function(t){e.editingDoc=null})}console.log("Constructing DocumentCtrl..."),e.uploadedDocs=[],e.log="",e.isSucceedUpload=0,e.title="",e.authors="",e["abstract"]="",e.publisher="",e.publishedDate="",e.isEditing=!1,isLoading=!1,e.peakUploaded=0,e.averageTimePerDay=0,e.uploadDocument=function(){e.uploadFile(e.file)},e.clearLog=function(){e.log="",e.isSucceedUpload=0},e.submit=function(){e.uploadDocument()},e.uploadFile=function(i){i&&(e.clearLog(),i.upload=t.upload({url:"http://localhost:3001/uploadDoc",data:{username:e.username,title:e.title,authors:e.authors,"abstract":e["abstract"],publisher:e.publisher,publishedDate:e.publishedDate,file:i}}).then(function(t){o(function(){var o="file: "+t.config.data.file.name+", Response: "+JSON.stringify(t.data);e.log=o,i.result=t.data,e.isSucceedUpload=e.isSucceedUpload+1}),e.isSucceedUpload=e.isSucceedUpload+1},function(t){t.status>0&&(e.log=t.status+": "+t.data)},function(t){var o=parseInt(100*t.loaded/t.total);i.progress=Math.min(o),e.log="progress: "+o+"% "+t.config.data.file.name,e.isSucceedUpload=e.isSucceedUpload+1}))},e.selectDocument=function(t){e.isEditing=!0,e.editingDoc=t,e.title=t.title,e.authors=t.authors,e["abstract"]=t["abstract"],e.publisher=t.publisher,e.publishedDate=t.publishedDate},e.saveEditedDoc=function(){e.editingDoc.title=e.title,e.editingDoc.authors=e.authors,e.editingDoc["abstract"]=e["abstract"],e.editingDoc.publisher=e.publisher,e.editingDoc.publishedDate=e.publishedDate,u(e.editingDoc)},e.exitEditing=function(){e.editingDoc=null,e.title="",e.authors="",e["abstract"]="",e.publisher="",e.publishedDate="",e.isEditing=!1},e.deleteDocument=function(t,o){n.removeDoc(o,function(e){console.log("delete document result: ",e)},function(e){console.log("Error when delete document: ",e)}),e.uploadedDocs.slice(t,1),l(n)},e.getServerDocumentPath=function(e){return n.getDocPath(e)},e.downloadDocument=function(e){console.log("come here 9!");var t=document.createElement("a");document.body.appendChild(t),t.style="display: none",t.href=n.getDocPath(e.uploadedPath),t.download=e.fileName,t.click(),document.body.removeChild(t)},e.$watch("isSucceedUpload",function(){e.isLoading=!0,l(n),e.isLoading=!1}),e.currentPage=0,e.pageSize=c.ITEMS_PER_PAGE,e.numberOfPages=function(){return Math.ceil(e.uploadedDocs/e.pageSize)}}angular.module("SDLMSys").controller("DocumentCtrl",["$scope","Upload","$timeout","$localStorage","DocumentSvc","PAGINATION",DocumentCtrl]);
" use strict";function MasterCtrl(t,e){console.log("Constructing MasterCtrl...");var o=992;t.getWidth=function(){return window.innerWidth},t.$watch(t.getWidth,function(g,l){g>=o?angular.isDefined(e.get("toggle"))?t.toggle=!!e.get("toggle"):t.toggle=!0:t.toggle=!1}),t.toggleSidebar=function(){t.toggle=!t.toggle,e.put("toggle",t.toggle)},window.onresize=function(){t.$apply()},console.log(t)}angular.module("SDLMSys").controller("MasterCtrl",["$scope","$cookieStore",MasterCtrl]);
" use strict";function SearchCtrl(t,e,o,n,s,a,i,c){function r(e){s.get(i.URL+e+"&pretty=true&size="+t.pageSize).then(function(e){if(console.log(e),200==e.status){var o=e.data.hits;t.resultDocs=o.hits,t.totalDocs=o.total}else console.log(e.statusText)})}function l(e){t.isLoading=!0,s.get(i.URL+t.query+"&pretty=true&size="+t.pageSize+"&from="+(e-1)*t.pageSize).then(function(e){if(console.log(e),200==e.status){var o=e.data.hits;t.resultDocs=o.hits,t.totalDocs=o.total}else console.log(e.statusText);t.isLoading=!1})}console.log("Constructing SearchCtrl..."),t.resultDocs=[],t.submit=function(){t.isLoading=!0,r(t.query),t.isLoading=!1},t.$watch("query",function(e){t.isLoading=!0,r(e),t.isLoading=!1}),t.pageChanged=function(t){l(t)},t.pagination={current:1},t.pageSize=c.ITEMS_PER_PAGE,t.totalDocs=0,t.getServerDocumentPath=function(t){return a.getDocPath(t)}}angular.module("SDLMSys").controller("SearchCtrl",["$scope","$filter","$timeout","$localStorage","$http","DocumentSvc","DOCUMENT_SEARCH","PAGINATION",SearchCtrl]);
function rdLoading(){var d={restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'};return d}angular.module("SDLMSys").directive("rdLoading",rdLoading);
function rdWidgetBody(){var d={requires:"^rdWidget",scope:{loading:"@?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"};return d}angular.module("SDLMSys").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){var e={requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"};return e}angular.module("SDLMSys").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){var i={requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"};return i}angular.module("SDLMSys").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){var d={transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"};return d}angular.module("SDLMSys").directive("rdWidget",rdWidget);
" use strict";angular.module("SDLMSys").filter("startFrom",function(){return function(r,t){return t=+t,r.slice(t)}});
"use strict";angular.module("SDLMSys").config(["$httpProvider",function(t){t.interceptors.push(["$q","$location","$localStorage",function(t,e,r){return{request:function(t){return t.headers=t.headers||{},r.token&&(t.headers.Authorization="Bearer "+r.token),t},responseError:function(r){return 401!==r.status&&403!==r.status||e.path("/"),t.reject(r)}}}])}]);
"use strict";function DocumentSvc(e,c,t){var o=t.URL;return{getMines:function(c,t){e.get(o+"/mydocs").success(c).error(t)},updateInfo:function(c,t,r){e.post(o+"/document",c).success(t).error(r)},removeDoc:function(c,t,r){e.post(o+"/deletedocument",c).success(t).error(r)},getDoc:function(c,t,r){e.get(o+"/"+c,{responseType:"arraybuffer"}).success(t).error(r)},getDocPath:function(e){return o+"/"+e}}}angular.module("SDLMSys").factory("DocumentSvc",["$http","$localStorage","DEPLOYED_HOST",DocumentSvc]);
"use strict";function MainSvc(e,t,n){function o(e){angular.extend(r,e)}function s(e){var t="";if(e)switch(e.replace("-","+"),t=t.replace("_","/"),t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}else console.log("The token string is empty! A Guest User!");return window.atob(t)}function a(){var e=t.token,n={};if("undefined"!=typeof e){var o=e.split(".")[1],a=s(o);a&&(n=JSON.parse(a))}return n}var c=n.URL,r=a();return{save:function(t,n,o){e.post(c+"/signup",t).success(n).error(o)},login:function(t,n,o){e.post(c+"/authen",t).success(n).error(o)},me:function(t,n){e.get(c+"/me").success(t).error(n)},logout:function(e){console.log("Logout has been called"),o({}),delete t.token,e()}}}angular.module("SDLMSys").constant("DEPLOYED_HOST",{URL:"http://localhost:3001"}).constant("DOCUMENT_SEARCH",{URL:"http://localhost:9200/documentlib/Document/_search?q="}).constant("PAGINATION",{ITEMS_PER_PAGE:10}).factory("MainSvc",["$http","$localStorage","DEPLOYED_HOST",MainSvc]);